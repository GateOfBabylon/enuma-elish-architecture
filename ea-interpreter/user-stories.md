## Потребителски истории

### Основни компоненти на интерпретатора

1. **Четене на конфигурация от YAML DSL файлове**
   - **Като** разработчик, **искам** интерпретаторът да зарежда DSL файлове във формат YAML **за да** може да обработва конфигурацията за задачите.
   - **Като** разработчик, **искам** интерпретаторът да разпознава основни DSL елементи като `executor`, `tasks`, `env` и `universe` **за да** гарантира основна структура на DSL-а.

2. **Парсване на DSL файлове**
   - **Като** разработчик, **искам** интерпретаторът да парсва YAML съдържанието в Go структури **за да** обработва конфигурацията за задачи по време на изпълнение.
   - **Като** разработчик, **искам** парсването да включва разпознаване на различни типове задачи (напр. `http` и `py`) **за да** поддържа разнообразие от операции.
   - **Като** разработчик, **искам** DSL компонентите като `Executor`, `Task`, `Env` и `Universe` да са правилно дефинирани **за да** гарантирам, че всички конфигурационни данни са разпознати.

3. **Поддръжка на типове екзекутори (`http` и `py`)**
   - **Като** потребител, **искам** интерпретаторът да разпознава `type: http` **за да** изпълнява задачи, които правят HTTP заявки.
   - **Като** потребител, **искам** интерпретаторът да разпознава `type: py` **за да** изпълнява Python задачи в Docker контейнери.
   - **Като** потребител, **искам** да имам лесен начин да конфигурирам и дефинирам различни типове задачи в една конфигурация **за да** изпълнявам сложни потоци от задачи.

### Поддръжка на `universe` обект

1. **Добавяне на Docker конфигурация чрез `universe`**
   - **Като** потребител, **искам** да мога да конфигурирам `universe` обекта, който включва `world` и `secret`, **за да** дефинирам специфични Docker образи за изпълнение на задачи.

2. **Използване на `universe.secret` за удостоверяване**
   - **Като** потребител, **искам** да имам опция за съхранение на креденшъли в `secret` **за да** гарантирам сигурен достъп до частни Docker образи.

3. **Стартиране на Docker контейнери за Python задачи**
   - **Като** потребител, **искам** Python задачите да се изпълняват в Docker контейнери, дефинирани чрез `universe.world` **за да** използвам специфични конфигурации за задачите.
   - **Като** разработчик, **искам** интерпретаторът да стартира Docker контейнер за всяка Python задача, базирана на конфигурацията в `universe` **за да** изолира всяка задача и да гарантира сигурна среда.

### Интеграция и изпълнение на `http` и `py` задачи

1. **Поддръжка за изпълнение на HTTP задачи**
   - **Като** разработчик, **искам** интерпретаторът да разпознава и изпълнява HTTP задачи **за да** изпращам заявки към външни API.
   - **Като** потребител, **искам** да мога да конфигурирам различни HTTP методи като `GET`, `POST`, `PUT` и `DELETE` **за да** изпълнявам заявки според изискванията на API.
   - **Като** потребител, **искам** да мога да задавам заглавни полета (headers) и тяло (body) за всяка заявка **за да** персонализирам заявките си.

2. **Управление на заглавни полета, условия и променливи в HTTP заявки**
   - **Като** разработчик, **искам** интерпретаторът да обработва и инжектира динамични стойности в заглавните полета и тялото на заявките **за да** улесня автоматизацията на HTTP задачи.
   - **Като** потребител, **искам** да използвам условно изпълнение в HTTP задачи, например чрез `condition`, **за да** контролирам кои заявки се изпълняват въз основа на резултатите от предишни задачи.

3. **Изпълнение на Python задачи чрез Docker**
   - **Като** потребител, **искам** Python задачите да се изпълняват в Docker, базирано на Docker образи в `universe.world`, **за да** гарантирам, че задачите се изпълняват в изолирана и контролирана среда.
   - **Като** разработчик, **искам** интерпретаторът да поддържа `script-path` конфигурация, която зарежда и изпълнява външни Python скриптове **за да** използвам вече съществуващи Python скриптове в задачите.

4. **Динамично подаване на параметри в Python задачи**
   - **Като** потребител, **искам** да подавам параметри към Python задачи чрез `script-path` **за да** използвам различни аргументи за всяка задача.
   - **Като** разработчик, **искам** да мога да дефинирам и обработвам променливи, които автоматично се подават като аргументи на Python задачи **за да** улесня интеграцията на скриптовете с интерпретатора.


## Задачи и подзадачи

### Основна структура и инициализация на проекта

1. **Инициализация на основни структури**
   - **Като** разработчик, **искам** да създам основни структури за `executor`, `task`, и `env` **за да** дефинирам рамката на интерпретатора.
   - **Като** разработчик, **искам** да дефинирам структурата за `executor` **за да** управлявам типовете задачи и тяхната конфигурация.
   - **Като** разработчик, **искам** да дефинирам структурата за `task`, която съдържа информация за всяка отделна задача, като метод, URL, и променливи **за да** се управляват правилно различните типове задачи.
   - **Като** разработчик, **искам** да създам структура за `env`, която съхранява глобални променливи **за да** улесня използването на стойности в различни задачи.

2. **Задаване на зависимости за Docker и HTTP**
   - **Като** разработчик, **искам** да добавя зависимост за Docker управление в Go проекта **за да** използвам Docker контейнери за Python задачи.
   - **Като** разработчик, **искам** да добавя зависимост за HTTP заявки **за да** мога да изпълнявам задачи с HTTP методи, като GET, POST и PUT.

3. **Създаване на основен файл за интерпретатора**
   - **Като** разработчик, **искам** да създам основния файл на интерпретатора, който ще контролира четенето и изпълнението на задачи **за да** осигуря главната точка за стартиране на изпълнението на конфигурацията.
   - **Като** разработчик, **искам** да дефинирам основната логика за стартиране на интерпретатора **за да** гарантирам правилното зареждане и изпълнение на задачите.

### Парсване на DSL файлове

1. **Зареждане на DSL файлове**
   - **Като** потребител, **искам** интерпретаторът да може да зарежда конфигурационни файлове в YAML формат **за да** предоставя конфигурация на задачи.

2. **Парсване на DSL файлове**
   - **Като** разработчик, **искам** DSL компонентите (`Executor`, `Task`, `Env`, и `Universe`) да бъдат правилно дефинирани в Go структури **за да** може интерпретаторът да разпознава и обработва елементите от конфигурацията.
   - **Като** разработчик, **искам** да създам функция за парсване на YAML файла **за да** конвертирам съдържанието на DSL файла в съответни Go структури.
   - **Като** разработчик, **искам** да поддържам конфигурацията за различни типове задачи (напр. `http` и `py`) **за да** могат да се разпознават и обработват различните типове задачи в DSL файла.

3. **Валидация на парсираните структури**
   - **Като** разработчик, **искам** интерпретаторът да валидира конфигурацията на `Executor`, `Task`, `Env`, и `Universe` **за да** се уверя, че всички нужни полета са налични и коректно зададени.
   - **Като** разработчик, **искам** интерпретаторът да съобщава за грешки, ако има липсващи или некоректни стойности **за да** мога да отстраня проблемите бързо.

### Управление на `http` задачи

1. **Изпълнение на HTTP задачи**
   - **Като** потребител, **искам** интерпретаторът да изпълнява HTTP заявки с различни методи (GET, POST, PUT, DELETE) **за да** извършвам специфични действия върху външни API.

2. **Управление на заглавни полета и тяло на заявките**
   - **Като** потребител, **искам** да мога да дефинирам `headers` и `body` за HTTP заявки **за да** конфигурирам съдържанието на заявките.
   - **Като** потребител, **искам** интерпретаторът да поддържа динамични заглавни полета и тяло на заявките, като използва стойности от `env` и `export` **за да** персонализирам заявките според нуждите на задачите.

3. **Управление на условия за изпълнение на HTTP задачи**
   - **Като** потребител, **искам** да мога да дефинирам `condition` за HTTP задачи **за да** контролирам изпълнението на задачите въз основа на резултатите от предишни задачи.

4. **Поддръжка на цикли (`loop`) и паралелно изпълнение (`parallel`)**
   - **Като** потребител, **искам** да дефинирам `loop` в HTTP задачи, който да изпълнява циклично заявки върху списък от елементи **за да** обработя масив от данни.
   - **Като** потребител, **искам** да използвам `parallel` в HTTP задачи, за да изпълня едновременно няколко задачи **за да** подобря производителността при многобройни независими заявки.

### Управление на `py` задачи чрез Docker

1. **Поддръжка на `py` задачи в Docker контейнери**
   - **Като** потребител, **искам** Python задачи да се изпълняват в Docker контейнери, дефинирани чрез `universe.world` **за да** осигуря изолирана среда за изпълнение.

2. **Управление на удостоверяване с `universe.secret`**
   - **Като** потребител, **искам** интерпретаторът да използва `universe.secret` **за да** удостоверява частни Docker образи при изтегляне.

3. **Подаване на параметри към Python задачи**
   - **Като** потребител, **искам** да подам аргументи към Python задачи чрез `script-path` **за да** конфигурирам скриптовете с различни параметри.
   - **Като** потребител, **искам** да добавя поддръжка за подаване на аргументи от `env` и `export` **за да** има динамика при изпълнение на Python задачи.

4. **Поддръжка на цикли (`loop`) и паралелно изпълнение (`parallel`) за Python задачи**
   - **Като** потребител, **искам** да дефинирам `loop` в Python задачи, който да изпълнява циклично Python скриптове върху списък от елементи **за да** обработя масив от данни.
   - **Като** потребител, **искам** да използвам `parallel` в Python задачи, за да изпълня едновременно няколко задачи **за да** подобря производителността при многобройни независими Python задачи.

### Управление на променливи и `env` стойности

1. **Определяне и използване на глобални променливи**
   - **Като** потребител, **искам** да дефинирам глобални променливи в `env`, които да бъдат използвани във всички задачи **за да** задавам стойности за общи параметри.

2. **Инжектиране на променливи със синтаксиса `${{variable_name}}`**
   - **Като** разработчик, **искам** интерпретаторът да поддържа синтаксиса `${{variable_name}}` **за да** инжектира динамични стойности от `env` или `export`.

3. **Експортиране на резултати от задачи в променливи**
   - **Като** потребител, **искам** резултатите от `http` и `py` задачи да се съхраняват в променливи, дефинирани с `export` **за да** ги използвам динамично в следващите задачи.

### Поддръжка на разширени функции за задачи

1. **Изпълнение на условни изрази в задачи**
   - **Като** потребител, **искам** да дефинирам условни изрази (`if`, `elif`, и `else`) за всяка задача **за да** контролирам кога и как се изпълнява всяка задача в зависимост от резултатите на предишни действия.

2. **Управление на времеви параметри**
   - **Като** потребител, **искам** да задавам `delay` за задачи, който отлага изпълнението им за определено време **за да** контролирам последователността на задачите.
   - **Като** потребител, **искам** да задавам `timeout` за всяка задача **за да** огранича времето за изпълнение и да предотвратя застой при изпълнение.